SELECT
ASSUMPTIONS_VAR_COST_DIM_KEY,
ORDER_DATE_DIM_KEY,
COUNT(DISTINCT SALES_ORDER_ID),
IS_MARKDOWN
FROM
    DBT_DATA_VAULT.DM.SALES_FACT
WHERE order_date_dim_key between '2023-01-31' and '2024-01-31'
AND SALES_TYPE = 'Products'
AND B2B_B2C = 'B2C'
AND NOT assumptions_var_cost_dim_key  like 'B2B%'
GROUP BY ORDER_DATE_DIM_KEY, assumptions_var_cost_dim_key, IS_MARKDOWN
ORDER BY ORDER_DATE_DIM_KEY DESC;
